exports.id=0,exports.modules={"./build/contracts/FlightSuretyData.json":function(e){e.exports=JSON.parse("{}")},"./src/server/server.js":function(e,t,n){"use strict";n.r(t);var r=n("./build/contracts/FlightSuretyApp.json"),o=(n("./build/contracts/FlightSuretyData.json"),n("./src/server/config.json")),c=n("web3"),a=n.n(c),s=n("express"),u=n.n(s);function i(e,t,n,r,o,c,a){try{var s=e[c](a),u=s.value}catch(e){return void n(e)}s.done?t(u):Promise.resolve(u).then(r,o)}function l(e){return function(){var t=this,n=arguments;return new Promise((function(r,o){var c=e.apply(t,n);function a(e){i(c,r,o,a,s,"next",e)}function s(e){i(c,r,o,a,s,"throw",e)}a(void 0)}))}}var f=o.localhost,d=new a.a(new a.a.providers.WebsocketProvider(f.url.replace("http","ws"))),h=new d.eth.Contract(r.abi,f.appAddress),p=[],g=[{label:"STATUS_CODE_UNKNOWN",code:0},{label:"STATUS_CODE_ON_TIME",code:10},{label:"STATUS_CODE_LATE_AIRLINE",code:20},{label:"STATUS_CODE_LATE_WEATHER",code:30},{label:"STATUS_CODE_LATE_TECHNICAL",code:40},{label:"STATUS_CODE_LATE_OTHER",code:50}];function m(){return(m=l(regeneratorRuntime.mark((function e(){var t,n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,h.methods.REGISTRATION_FEE().call();case 2:return t=e.sent,e.next=5,d.eth.getAccounts();case 5:n=e.sent,console.log(n),n.forEach(function(){var e=l(regeneratorRuntime.mark((function e(n){var r;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,h.methods.registerOracle().send({from:n,value:t,gas:4712388e4,gasPrice:1e5});case 2:return e.sent,e.next=5,h.methods.getMyIndexes.call({from:n});case 5:r=e.sent,console.log(r),console.log("Oracle ".concat(n," registered: ").concat(r[0],", ").concat(r[1],", ").concat(r[2]));case 8:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}());case 8:case"end":return e.stop()}}),e)})))).apply(this,arguments)}!function(){m.apply(this,arguments)}(),h.events.OracleRequest({fromBlock:"latest"},function(){var e=l(regeneratorRuntime.mark((function e(t,n){var r,o,c,a,s,u;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t&&console.log(t),r=n.returnValues.airline,o=n.returnValues.flight,c=n.returnValues.timestamp,a=!1,s=g[1],u=1e3*c,console.log("Flight scheduled to: ".concat(new Date(u))),u<Date.now()&&(s=g[2]),p.forEach((function(e,t){if(a)return!1;for(var n=function(n){if(a)return"break";20===s.code&&h.methods.creditInsurees(accounts[t],o).send({from:accounts[t]}).then((function(e){console.log("Flight ".concat(o," got covered and insured the users"))})).catch((function(e){console.log(e.message)})),h.methods.submitOracleResponse(e[n],r,o,c,s.code).send({from:accounts[t]}).then((function(t){a=!0,console.log("Oracle: ".concat(e[n]," responded from flight ").concat(o," with status ").concat(s.code," - ").concat(s.label))})).catch((function(e){console.log(e.message)}))},u=0;u<3;u+=1){if("break"===n(u))break}}));case 10:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}());var v=u()();v.get("/api",(function(e,t){t.send({message:"An API for use with your Dapp!"})})),t.default=v}};